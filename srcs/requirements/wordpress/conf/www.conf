; -----------------------------------------------------------------------------
; This file configures the 'www' pool of PHP workers that will execute the
; WordPress application code.
; -----------------------------------------------------------------------------

[www]

; WHAT FOR: This is a critical security setting. It forces the PHP processes
;           to run as the unprivileged 'nobody' user. If a vulnerability were
;           ever exploited in WordPress or a plugin, the attacker's capabilities
;           would be confined to this low-permission user, not root.
user = nobody
group = nobody

; Tells PHP-FPM to listen for requests from Nginx on port 9000. This must
; match the 'fastcgi_pass' directive in the Nginx configuration.
listen = 9000

; --- Process Management ---
; WHAT FOR: These settings control how PHP-FPM manages worker processes to
;           balance performance and server memory usage, which is especially
;           important in a resource-constrained VM.
;
; 'dynamic' is chosen as a balanced approach: it keeps a minimum number of
; processes ready for instant response while being able to scale up for traffic
; spikes and scale back down to conserve RAM during idle periods.
pm = dynamic
pm.max_children = 5
pm.start_servers = 2
pm.min_spare_servers = 1
pm.max_spare_servers = 3

; WHAT FOR: This directive is MANDATORY for this project to function. By default,
;           PHP-FPM clears all environment variables for security. However, the
;           entire Docker setup relies on passing configuration (like database
;           credentials) via environment variables. Setting 'clear_env = no'
;           ensures that these crucial variables are inherited by the PHP
;           processes, allowing WordPress to connect to the database.
clear_env = no